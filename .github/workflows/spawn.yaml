name: Use Spawn Actions

on:
  workflow_dispatch: {}

jobs:
  exercise-actions:
    name: Exercise Spawn GH Actions
    runs-on: ubuntu-latest
    steps:
      - name: create empty pg container
        id: create
        uses: red-gate/spawn-ci-plugins/github/data-container/create@symlink-to-dockerfile
        with:
          dataImage: 11780 # An empty postgres image
          lifetime: '5h'
      - name: save container
        uses: red-gate/spawn-ci-plugins/github/data-container/save@symlink-to-dockerfile
        with:
          dataContainer: ${{ steps.create.outputs.dataContainerName }}
      - name: reset container
        uses: red-gate/spawn-ci-plugins/github/data-container/reset@symlink-to-dockerfile
        with:
          dataContainer: ${{ steps.create.outputs.dataContainerName }}
      - name: delete container
        uses: red-gate/spawn-ci-plugins/github/data-container/delete@symlink-to-dockerfile
        with:
          dataContainer: ${{ steps.create.outputs.dataContainerName }}
env:
  SPAWNCTL_ACCESS_TOKEN: ${{ secrets.SPAWNCTL_ACCESS_TOKEN }}
